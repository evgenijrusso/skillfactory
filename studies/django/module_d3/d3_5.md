# D3.5. DDL. Создание объектов. CREATE

Приступим к изучению операторов, работающих с объектами и самими БД.

Оператор CREATE создаёт базы данных и любые их объекты.

### Основными объектами, которые чаще всего приходится создавать, являются:
- таблицы,
- атрибуты (столбцы) таблиц,
- индексы,
- последовательности.

### Уточнение. 
Как правило, сами базы данных создаются интерактивно с помощью утилиты командной строки или 
графических инструментов вроде PGAdmin. Поэтому здесь и далее под объектами мы будем понимать любые объекты, 
кроме самих баз данных. Кроме того, запрос на создание БД в PostgreSQL нельзя совместить с операторами, 
изменяющими структуру этой БД.

### Давайте рассмотрим несколько примеров:

-- Создание таблицы «Товары».
```
CREATE TABLE products (
    id BIGSERIAL PRIMARY KEY, -- первичный ключ
    name TEXT NOT NULL, -- название товара
    price INT CHECK(price > 0), -- цена (гарантируется, что цена > 0)
    vendor_id BIGINT REFERENCES vendors(id), -- ссылка на продавца
    manufacturer_id BIGINT REFERENCES manufacturers(id) -- ссылка на производителя
);

-- Создание индекса для ускорения поиска по названию товара.
CREATE INDEX product_name_idx ON products(name);
```
В примере выше создаётся два объекта: таблица и индекс. Как вы можете видеть, сами операции внешне сильно отличаются, 
но структура сохраняется. Давайте разберём эти примеры.
```
CREATE TABLE имя_таблицы (
      имя_столбца_1 ТИП_ДАННЫХ ОГРАНИЧЕНИЕ,
      .....
      имя_столбца_n ТИП_ДАННЫХ ОГРАНИЧЕНИЕ
);
```

Для индекса схема та же:
```
CREATE INDEX имя_индекса ON имя_таблицы (имя_поля) [USING алгоритм];
```
В квадратных скобках указана опция по умолчанию.

Операторы создания объектов, как вы заметили, имеют огромное количество различных опциональных параметров. 
Хорошая новость в том, что большинство из них обычно не используются.
Однако стоит обязательно изучить ограничения, доступные при описании столбцов таблиц.

Ограничение	    Описание
------------------------------------------------------------------------------------------------------------
NOT NULL	    Гарантирует, что в БД не попадут пустые значения.
------------------------------------------------------------------------------------------------------------
UNIQUE	        Гарантирует, что для данного столбца или группы столбцов все значения в таблице будут различаться.
------------------------------------------------------------------------------------------------------------
PRIMARY KEY	    Делает атрибут или группу атрибутов первичным ключом (то есть NOT NULL UNIQUE).
------------------------------------------------------------------------------------------------------------
FOREIGN KEY	    Обозначает внешний ключ: атрибут или группа атрибутов ссылаются на ключи в другой таблице и должны совпадать со значениями в ней.
------------------------------------------------------------------------------------------------------------
CHECK	        Произвольная проверка содержимого ячеек одного или нескольких столбцов.
------------------------------------------------------------------------------------------------------------
DEFAULT	        Предоставляет для столбца значение по умолчанию.
------------------------------------------------------------------------------------------------------------

* Термины «столбец» и «атрибут» мы используем как синонимы.
* В языке SQL пустое (отсутствующее) значение ячейки таблицы имеет специальное имя — NULL. 
NULL универсален и применяется к столбцам с любыми типами данных. Если где-то значение в ячейке не указано, то там записывается NULL.
* Гарантия, которую предоставляет СУБД для ограничений, означает, что если попытаться создать или изменить запись так, 
что она будет противоречить ограничению, то СУБД выдаст ошибку и операция не будет зафиксирована в БД.

Примеры: 

CREATE TABLE adverts (
	id BIGSERIAL PRIMARY KEY,
	name TEXT NOT NULL,
	user_id BIGINT UNIQUE,
	text TEXT CHECK (length(text) <= 1000)
);
CREATE TABLE posts (
	id SERIAL PRIMARY KEY,
	author TEXT NOT NULL UNIQUE,
	content TEXT NOT NULL
);

